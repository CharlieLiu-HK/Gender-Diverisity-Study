)
regression_1_data <- Linked_JUPAS_With_CGA
regression_1_data <- regression_1_data %>%
mutate(
Cohort_2020 = case_when(
Cohort_Academic_Year == 2019 ~ 0,
Cohort_Academic_Year == 2020 ~ 1
),
.after = Female,
Cohort_Academic_Year = NULL
)
regression_1_data <- regression_1_data %>%
mutate(
Cohort_2020 = case_when(
Cohort_Academic_Year == 2019 ~ 0,
Cohort_Academic_Year == 2020 ~ 1
),
.after = Female,
Cohort_Academic_Year = NULL
)
regression_1_data <- regression_1_data %>%
mutate(
Female = case_when(
Gender == "Male" ~ 0,
Gender == "Female" ~ 1
),
.after = Student_ID,
Gender = NULL
)
regression_1_data <- regression_1_data %>%
mutate(
Cohort_2020 = case_when(
Cohort_Academic_Year == 2019 ~ 0,
Cohort_Academic_Year == 2020 ~ 1
),
.after = Female,
Cohort_Academic_Year = NULL
)
View(regression_1_data)
regression_1_data <- regression_1_data %>%
mutate(
Second_Year = case_when(
Year_Of_Study == "01" ~ 0,
Year_Of_Study == "02" ~ 1
),
.after = Snapped_Date,
Year_Of_Study = NULL
)
regression_1_data <- regression_1_data %>%
mutate(
Second_Year = case_when(
Year_Of_Study == "01" ~ 0,
Year_Of_Study == "02" ~ 1
),
.after = Snapped_Date,
Year_Of_Study = NULL
)
regression_1_data <- regression_1_data %>%
mutate(
SBM = case_when(
School_Code == "SBM" ~ 1,
TRUE ~ 0
),
SENG = case_when(
School_Code == "SENG" ~ 1,
TRUE ~ 0
),
SSCI = case_when(
School_Code == "SSCI" ~ 1,
TRUE ~ 0
),
.after = Major_Minor,
School_Code = NULL
)
regression_1_data <- regression_1_data %>%
mutate(
Minor = case_when(
Major_Minor == "PMAJ" ~ 0,
Major_Minor %in% c("OMAJ", "MIN") ~ 1
),
.after = Best_Chinese,
Major_Minor = NULL
)
model_1_fit <- lm(CGA ~ Female, data = regression_1_data)
model_2_fit <- lm(CGA ~ Female + Cohort_2020, data = regression_1_data)
model_3_fit <- lm(CGA ~ Female + Cohort_2020 + Second_Year, data = regression_1_data)
model_4_fit <- lm(CGA ~ Female + Cohort_2020 + Second_Year + SBM + SENG + SSCI, data = regression_1_data)
model_5_fit <- lm(CGA ~ Female + Cohort_2020 + Second_Year + SBM + SENG + SSCI + Minor, data = regression_1_data)
model_6_fit <- lm(CGA ~ Female + Cohort_2020 + Second_Year + SBM + SENG + SSCI + Minor + Overall_Score, data = regression_1_data)
model_7_fit <- lm(CGA ~ Female + Cohort_2020 + Second_Year + SBM + SENG + SSCI + Minor + Overall_Score + Best_Math + Best_English + Best_Liberal_Studies, data = regression_1_data)
regression_2_data <- Linked_JUPAS_Application_Profile
regression_2_data <- regression_2_data %>%
mutate(
Admission_Status = case_when(
Enrollment_Status == "No offer from HKUST" ~ 0,
Enrollment_Status %in% c("Offered and enrolled", "Offered anything but did not choose to attend") ~ 1
),
.before = Registered_School,
Enrollment_Status = NULL
)
#length(regression_2_data$Admission_Status)
#sum(regression_2_data$Admission_Status)
#mean(regression_2_data$Admission_Status)
regression_2_data <- regression_2_data %>%
mutate(
Female = case_when(
Gender == "Male" ~ 0,
Gender == "Female" ~ 1
),
.before = Overall_Score,
Gender = NULL
)
#length(regression_2_data$Female)
#sum(regression_2_data$Female)
#mean(regression_2_data$Female)
regression_2_data <- regression_2_data %>%
mutate(
Cohort_2020 = case_when(
Cohort_Year == 2019 ~ 0,
Cohort_Year == 2020 ~ 1
),
.before = Female,
Cohort_Year = NULL
)
#length(regression_2_data$Cohort_2020)
#sum(regression_2_data$Cohort_2020)
#mean(regression_2_data$Cohort_2020)
regression_2_data <- regression_2_data %>%
mutate(
SBM = case_when(
Applied_School == "SBM" ~ 1,
TRUE ~ 0
),
SENG = case_when(
Applied_School == "SENG" ~ 1,
TRUE ~ 0
),
SSCI = case_when(
Applied_School == "SSCI" ~ 1,
TRUE ~ 0
),
.before = Applied_Program_Name,
Applied_School = NULL
)
#length(regression_2_data$SBM)
#sum(regression_2_data$SBM, na.rm = T)
#mean(regression_2_data$SBM, na.rm = T)
#length(regression_2_data$SENG)
#sum(regression_2_data$SENG, na.rm = T)
#mean(regression_2_data$SENG, na.rm = T)
#length(regression_2_data$SSCI)
#sum(regression_2_data$SSCI, na.rm = T)
#mean(regression_2_data$SSCI, na.rm = T)
model_21_fit <- glm(Admission_Status ~ Female, data = regression_2_data, family = binomial(link = "logit"))
model_22_fit <- glm(Admission_Status ~ Female + Cohort_2020, data = regression_2_data, family = binomial(link = "logit"))
model_23_fit <- glm(Admission_Status ~ Female + Cohort_2020 + SBM + SENG + SSCI, data = regression_2_data, family = binomial(link = "logit"))
model_24_fit <- glm(Admission_Status ~ Female + Cohort_2020 + SBM + SENG + SSCI + Overall_Score, data = regression_2_data, family = binomial(link = "logit"))
model_25_fit <- glm(Admission_Status ~ Female + Cohort_2020 + SBM + SENG + SSCI + Overall_Score + Best_Math + Best_English + Best_Liberal_Studies, data = regression_2_data, family = binomial(link = "logit"))
phicoef(regression_1_data$Female %>% as.logical(), regression_1_data$Cohort_2020 %>% as.logical())
phicoef(regression_1_data$Female %>% as.logical(), regression_1_data$SBM %>% as.logical())
phicoef(regression_1_data$Female %>% as.logical(), regression_1_data$SENG %>% as.logical())
phicoef(regression_1_data$Female %>% as.logical(), regression_1_data$SSCI %>% as.logical())
phicoef(regression_1_data$Cohort_2020 %>% as.logical(), regression_1_data$SBM %>% as.logical())
phicoef(regression_1_data$Cohort_2020 %>% as.logical(), regression_1_data$SENG %>% as.logical())
phicoef(regression_1_data$Cohort_2020 %>% as.logical(), regression_1_data$SSCI %>% as.logical())
phicoef(regression_1_data$SBM %>% as.logical(), regression_1_data$SENG %>% as.logical())
phicoef(regression_1_data$SBM %>% as.logical(), regression_1_data$SSCI %>% as.logical())
phicoef(regression_1_data$SENG %>% as.logical(), regression_1_data$SSCI %>% as.logical())
phicoef(regression_2_data$Female %>% as.logical(), regression_2_data$Cohort_2020 %>% as.logical())
phicoef(regression_2_data$Female %>% as.logical(), regression_2_data$SBM %>% as.logical())
phicoef(regression_2_data$Female %>% as.logical(), regression_2_data$SENG %>% as.logical())
phicoef(regression_2_data$Female %>% as.logical(), regression_2_data$SSCI %>% as.logical())
phicoef(regression_2_data$Cohort_2020 %>% as.logical(), regression_2_data$SBM %>% as.logical())
phicoef(regression_2_data$Cohort_2020 %>% as.logical(), regression_2_data$SENG %>% as.logical())
phicoef(regression_2_data$Cohort_2020 %>% as.logical(), regression_2_data$SSCI %>% as.logical())
phicoef(regression_2_data$Cohort_2020 %>% as.logical(), regression_2_data$SBM %>% as.logical())
phicoef(regression_2_data$Cohort_2020 %>% as.logical(), regression_2_data$SENG %>% as.logical())
phicoef(regression_2_data$Cohort_2020 %>% as.logical(), regression_2_data$SSCI %>% as.logical())
phicoef(regression_2_data$SBM %>% as.logical(), regression_1_data$SENG %>% as.logical())
phicoef(regression_2_data$SBM %>% as.logical(), regression_2_data$SENG %>% as.logical())
phicoef(regression_2_data$SBM %>% as.logical(), regression_2_data$SSCI %>% as.logical())
phicoef(regression_2_data$SENG %>% as.logical(), regression_2_data$SSCI %>% as.logical())
cor.test(regression_2_data$Overall_Score, regression_2_data$Female)
cor.test(regression_2_data$Overall_Score, regression_2_data$Cohort_2020)
cor.test(regression_2_data$Overall_Score, regression_2_data$SBM)
cor.test(regression_2_data$Overall_Score, regression_2_data$SENG)
cor.test(regression_2_data$Overall_Score, regression_2_data$SSCI)
cor.test(regression_2_data$Best_Math, regression_2_data$Female)
cor.test(regression_2_data$Best_Math, regression_2_data$Cohort_2020)
cor.test(regression_2_data$Best_Math, regression_2_data$SBM)
cor.test(regression_2_data$Best_Math, regression_2_data$SENG)
cor.test(regression_2_data$Best_Math, regression_2_data$SSCI)
cor.test(regression_2_data$Best_Math, regression_2_data$Overall_Score)
cor.test(regression_2_data$Best_English, regression_2_data$Female)
cor.test(regression_2_data$Best_English, regression_2_data$Cohort_2020)
cor.test(regression_2_data$Best_English, regression_2_data$SBM)
cor.test(regression_2_data$Best_English, regression_2_data$SENG)
cor.test(regression_2_data$Best_English, regression_2_data$SSCI)
cor.test(regression_2_data$Best_English, regression_2_data$Overall_Score)
cor.test(regression_2_data$Best_English, regression_2_data$Best_Math)
cor.test(regression_2_data$Best_Liberal_Studies, regression_2_data$Female)
cor.test(regression_2_data$Best_Liberal_Studies, regression_2_data$Female)
cor.test(regression_2_data$Best_Liberal_Studies, regression_2_data$Cohort_2020)
cor.test(regression_2_data$Best_Liberal_Studies, regression_2_data$SBM)
cor.test(regression_2_data$Best_Liberal_Studies, regression_2_data$SENG)
cor.test(regression_2_data$Best_Liberal_Studies, regression_2_data$SSCI)
cor.test(regression_2_data$Best_Liberal_Studies, regression_2_data$Overall_Score)
cor.test(regression_2_data$Best_Liberal_Studies, regression_2_data$Best_Math)
cor.test(regression_2_data$Best_Liberal_Studies, regression_2_data$Best_English)
install.packages("lavann")
install.packages("lavaan")
library(lavaan)
View(regression_1_data)
"
specmod <- "
specmod <- "
# Path a (direct effect): Gender to CGA
CGA ~ a * Female
# Path b: Gender to JUPAS Math Score
Best_Math ~ b * Female
# Path c: JUPAS Math SCore to CGA
CGA ~ c * Best_Math
# Path d: Gender to JUPAS English Score
Best_English ~ d * Female
# Path e: JUPAS English Score to CGA
CGA ~ e * Best_English
# Path f: Gender to JUPAS Liberal Studies Score
Best_Liberal_Studies ~ f * Female
# Path g: JUPAS Liberal Studies Score to CGA
CGA ~ g * Best_Liberal_Studies
# Indirect Effects
bc := b * c
de := d * e
fg := f * g
"
fitmod_1 <- sem(specmod, data = regression_1_data)
summary(fitmod, fit.measures = T, rsquare=T)
fitmod_1 <- sem(specmod, data = regression_1_data)
summary(fitmod_1, fit.measures = T, rsquare=T)
set.seed(209)
set.seed(229)
fitmod_1 <- sem(specmod, data = regression_1_data, se="bootstrap", bootstrap = 2000)
fitmod_1 <- sem(specmod, data = regression_1_data, se="bootstrap", bootstrap = 5000)
parameterEstimates(fitmod_2, ci = TRUE, level = 0.95, boot.ci.type = "perc")
parameterEstimates(fitmod_1, ci = TRUE, level = 0.95, boot.ci.type = "perc")
parameterEstimates(fitmod_1, ci = TRUE, level = 0.95, boot.ci.type = "perc")
parameterEstimates(fitmod_1, ci = TRUE, level = 0.95, boot.ci.type = "perc")
summary(fitmod_1)
unlink("Analysis'_cache", recursive = TRUE)
parameterEstimates(fitmod_1, ci = TRUE, level = 0.95, boot.ci.type = "perc")
parameterEstimates(fitmod_1, ci = TRUE, level = 0.95, boot.ci.type = "perc")
summary(fitmod_1)
summary(fitmod_1, fit.measures = T)
library(GenomicRanges)
library(tidyverse)
library(plotly)
library(ggthemes)
library(modelr)
library(coefplot)
library(effsize)
library(nortest)
library(lavaan)
UG_Profile_With_CGA <- read_csv("Data/DM_UG_PROFILE_W_CGA.csv")
UG_JUPAS_Application_Score <- read_csv("Data/DM_UG_JUPAS_ADM_SCORE.csv")
UG_JUPAS_Application_Program <- read_csv("Data/DM_UG_JUPAS_ADM_SCORE_PROG.csv")
UG_JUPAS_Application_Score <- UG_JUPAS_Application_Score %>%
select("Masked Appl Nbr", "Cohort Yr", "Sex Ind", "Score Rule Desc", "Score Value", "Status", "Reg Prog Nam", "Wh Stdt Key")
colnames(UG_JUPAS_Application_Score) <- c("Application_Number", "Cohort_Year", "Gender", "Score_Subject", "Score_Value",  "Enrollment_Status", "Registered_Program_Name", "Student_ID")
UG_JUPAS_Application_Score <- UG_JUPAS_Application_Score %>%
arrange(Application_Number, Cohort_Year)
UG_JUPAS_Application_Program <- UG_JUPAS_Application_Program %>%
select("Masked Appl Nbr", "Cohort Yr", "Prog Nam", "Wh Stdt Key")
colnames(UG_JUPAS_Application_Program) <- c("Application_Number", "Cohort_Year", "Applied_Program_Name", "Student_ID")
UG_JUPAS_Application_Program <- UG_JUPAS_Application_Program %>%
arrange(Application_Number, Cohort_Year)
UG_Profile_With_CGA <- UG_Profile_With_CGA %>%
select("Wh Stdt Key", "Cohort Term Acad Year", "Cohort Term Desc", "Snap Dat", "Sex Desc", "CGA",  "Study Yr", "Major Minor Cde", "Schl Cde", "Dept Cde", "Dept Formal Desc", "Ctzship Cntry Desc")
colnames(UG_Profile_With_CGA) <- c("Student_ID", "Cohort_Academic_Year", "Cohort_Academic_Term", "Snapped_Date", "Gender", "CGA", "Year_Of_Study", "Major_Minor", "School_Code", "Department_Code", "Department_Name", "Country_Of_Citizenship")
UG_Profile_With_CGA <- UG_Profile_With_CGA %>%
filter(Country_Of_Citizenship == "Hong Kong SAR, China" & Cohort_Academic_Year %in% c(2019, 2020) & Year_Of_Study %in% c("01", "02")) %>%
arrange(Student_ID, Cohort_Academic_Year)
set.seed(229)
UG_JUPAS_Application_Score <- UG_JUPAS_Application_Score %>%
pivot_wider(names_from = Score_Subject, values_from = Score_Value) %>%
select("Application_Number", "Cohort_Year", "Gender", "#Unweight Best 5 (incl.M1M2)", "Best Math(Comp)", "Best English", "Best Liberal Studies", "Best Chinese (with NCS)", "Enrollment_Status", "Registered_Program_Name", "Student_ID") %>%
rename(Overall_Score = `#Unweight Best 5 (incl.M1M2)`, Best_Math = `Best Math(Comp)`, Best_English = `Best English`, Best_Liberal_Studies = `Best Liberal Studies`, Best_Chinese = `Best Chinese (with NCS)`)
Linked_JUPAS_Application_Profile <- full_join(x = UG_JUPAS_Application_Program, y = UG_JUPAS_Application_Score, by = c("Application_Number", "Cohort_Year", "Student_ID")) %>%
select("Application_Number", "Cohort_Year", "Gender", "Overall_Score", "Best_Math", "Best_English", "Best_Liberal_Studies", "Best_Chinese", "Applied_Program_Name", "Enrollment_Status", "Registered_Program_Name", "Student_ID") %>%
mutate(
Gender = case_when(
Gender == "M" ~ "Male",
Gender == "F" ~ "Female"
)
) %>%
mutate(
Applied_School = case_when(
Applied_Program_Name %in% c("Bachelor Degree SENG: 4Y", "BSc(MAEC): 4Y", "BSc(ISD): 4Y") ~ "SENG",
Applied_Program_Name %in% c("Bachelor Degree SSCI: 4Y", "Bachelor Deg SSCI(Group B): 4Y", "Bachelor Degree SSCI (IRE): 4Y", "Bachelor Deg SSCI(Group A): 4Y") ~ "SSCI",
Applied_Program_Name %in% c("Bachelor Degree SBM: 4Y", "BSc(QFIN): 4Y", "BBA(ECON): 4Y", "BBA(IS): 4Y", "BBA(ACCT): 4Y", "BBA(FINA): 4Y", "BBA(MGMT): 4Y", "BBA(OM): 4Y", "BSc(RMBI): 4Y", "BBA(MARK): 4Y", "BBA(GBUS): 4Y") ~ "SBM",
Applied_Program_Name %in% c("BSc(GCS): 4Y", "Dual Degree Pgm-Tech&Mgt: 4Y", "BSc(EVMT): 4Y", "BSc(QSA): 4Y", "BSc(BIBU): 4Y", "BSc(ECOF): 4Y") ~ "SHSS & IPO"
),
.before = "Applied_Program_Name"
) %>%
mutate(
Registered_School = case_when(
Registered_Program_Name %in% c("Bachelor Degree SENG: 4Y", "BSc(MAEC): 4Y", "BSc(ISD): 4Y") ~ "SENG",
Registered_Program_Name %in% c("Bachelor Degree SSCI: 4Y", "Bachelor Deg SSCI(Group B): 4Y", "Bachelor Degree SSCI (IRE): 4Y", "Bachelor Deg SSCI(Group A): 4Y") ~ "SSCI",
Registered_Program_Name %in% c("Bachelor Degree SBM: 4Y", "BSc(QFIN): 4Y", "BBA(ECON): 4Y", "BBA(IS): 4Y", "BBA(ACCT): 4Y", "BBA(FINA): 4Y", "BBA(MGMT): 4Y", "BBA(OM): 4Y", "BSc(RMBI): 4Y", "BBA(MARK): 4Y", "BBA(GBUS): 4Y") ~ "SBM",
Registered_Program_Name %in% c("BSc(GCS): 4Y", "Dual Degree Pgm-Tech&Mgt: 4Y", "BSc(EVMT): 4Y", "BSc(QSA): 4Y", "BSc(BIBU): 4Y", "BSc(ECOF): 4Y") ~ "SHSS & IPO"
),
.before = "Registered_Program_Name"
)
Linked_JUPAS_With_CGA <- left_join(UG_Profile_With_CGA, Linked_JUPAS_Application_Profile %>% filter(Registered_Program_Name == Applied_Program_Name), by = c("Student_ID", "Cohort_Academic_Year" = "Cohort_Year", "Gender")) %>%
select("Application_Number", "Student_ID", "Gender", "Cohort_Academic_Year", "Cohort_Academic_Term", "Snapped_Date", "Year_Of_Study", "Overall_Score", "Best_Math", "Best_English", "Best_Liberal_Studies", "Best_Chinese", "Major_Minor", "School_Code", "Department_Code", "Department_Name", "Registered_Program_Name", "CGA") %>%
mutate(
School_Code = case_when(
School_Code %in% c("JS", "IPO", "SHSS") ~ "SHSS & IPO",
TRUE ~ School_Code
)
)
regression_1_data <- Linked_JUPAS_With_CGA
regression_1_data <- regression_1_data %>%
mutate(
Female = case_when(
Gender == "Male" ~ 0,
Gender == "Female" ~ 1
),
.after = Student_ID,
Gender = NULL
)
#length(regression_1_data$Female)
#sum(regression_1_data$Female, na.rm = T)
#mean(regression_1_data$Female, na.rm = T)
regression_1_data <- regression_1_data %>%
mutate(
Cohort_2020 = case_when(
Cohort_Academic_Year == 2019 ~ 0,
Cohort_Academic_Year == 2020 ~ 1
),
.after = Female,
Cohort_Academic_Year = NULL
)
#length(regression_1_data$Cohort_2020)
#sum(regression_1_data$Cohort_2020, na.rm = T)
#mean(regression_1_data$Cohort_2020, na.rm = T)
regression_1_data <- regression_1_data %>%
mutate(
Second_Year = case_when(
Year_Of_Study == "01" ~ 0,
Year_Of_Study == "02" ~ 1
),
.after = Snapped_Date,
Year_Of_Study = NULL
)
#length(regression_1_data$Second_Year)
#sum(regression_1_data$Second_Year, na.rm = T)
#mean(regression_1_data$Second_Year, na.rm = T)
regression_1_data <- regression_1_data %>%
mutate(
SBM = case_when(
School_Code == "SBM" ~ 1,
TRUE ~ 0
),
SENG = case_when(
School_Code == "SENG" ~ 1,
TRUE ~ 0
),
SSCI = case_when(
School_Code == "SSCI" ~ 1,
TRUE ~ 0
),
.after = Major_Minor,
School_Code = NULL
)
#length(regression_1_data$SBM)
#sum(regression_1_data$SBM, na.rm = T)
#mean(regression_1_data$SBM, na.rm = T)
#length(regression_1_data$SENG)
#sum(regression_1_data$SENG, na.rm = T)
#mean(regression_1_data$SENG, na.rm = T)
#length(regression_1_data$SSCI)
#sum(regression_1_data$SSCI, na.rm = T)
#mean(regression_1_data$SSCI, na.rm = T)
regression_1_data <- regression_1_data %>%
mutate(
Minor = case_when(
Major_Minor == "PMAJ" ~ 0,
Major_Minor %in% c("OMAJ", "MIN") ~ 1
),
.after = Best_Chinese,
Major_Minor = NULL
)
#length(regression_1_data$Minor)
#sum(regression_1_data$Minor, na.rm = T)
#mean(regression_1_data$Minor, na.rm = T)
model_1_fit <- lm(CGA ~ Female, data = regression_1_data)
#summary(model_1_fit)
model_2_fit <- lm(CGA ~ Female + Cohort_2020, data = regression_1_data)
#summary(model_2_fit)
model_3_fit <- lm(CGA ~ Female + Cohort_2020 + Second_Year, data = regression_1_data)
#summary(model_3_fit)
model_4_fit <- lm(CGA ~ Female + Cohort_2020 + Second_Year + SBM + SENG + SSCI, data = regression_1_data)
#summary(model_4_fit)
model_5_fit <- lm(CGA ~ Female + Cohort_2020 + Second_Year + SBM + SENG + SSCI + Minor, data = regression_1_data)
#summary(model_5_fit)
model_6_fit <- lm(CGA ~ Female + Cohort_2020 + Second_Year + SBM + SENG + SSCI + Minor + Overall_Score, data = regression_1_data)
#summary(model_6_fit)
model_7_fit <- lm(CGA ~ Female + Cohort_2020 + Second_Year + SBM + SENG + SSCI + Minor + Overall_Score + Best_Math + Best_English + Best_Liberal_Studies, data = regression_1_data)
#summary(model_7_fit)
regression_2_data <- Linked_JUPAS_Application_Profile
regression_2_data <- regression_2_data %>%
mutate(
Admission_Status = case_when(
Enrollment_Status == "No offer from HKUST" ~ 0,
Enrollment_Status %in% c("Offered and enrolled", "Offered anything but did not choose to attend") ~ 1
),
.before = Registered_School,
Enrollment_Status = NULL
)
#length(regression_2_data$Admission_Status)
#sum(regression_2_data$Admission_Status)
#mean(regression_2_data$Admission_Status)
regression_2_data <- regression_2_data %>%
mutate(
Female = case_when(
Gender == "Male" ~ 0,
Gender == "Female" ~ 1
),
.before = Overall_Score,
Gender = NULL
)
#length(regression_2_data$Female)
#sum(regression_2_data$Female)
#mean(regression_2_data$Female)
regression_2_data <- regression_2_data %>%
mutate(
Cohort_2020 = case_when(
Cohort_Year == 2019 ~ 0,
Cohort_Year == 2020 ~ 1
),
.before = Female,
Cohort_Year = NULL
)
#length(regression_2_data$Cohort_2020)
#sum(regression_2_data$Cohort_2020)
#mean(regression_2_data$Cohort_2020)
regression_2_data <- regression_2_data %>%
mutate(
SBM = case_when(
Applied_School == "SBM" ~ 1,
TRUE ~ 0
),
SENG = case_when(
Applied_School == "SENG" ~ 1,
TRUE ~ 0
),
SSCI = case_when(
Applied_School == "SSCI" ~ 1,
TRUE ~ 0
),
.before = Applied_Program_Name,
Applied_School = NULL
)
#length(regression_2_data$SBM)
#sum(regression_2_data$SBM, na.rm = T)
#mean(regression_2_data$SBM, na.rm = T)
#length(regression_2_data$SENG)
#sum(regression_2_data$SENG, na.rm = T)
#mean(regression_2_data$SENG, na.rm = T)
#length(regression_2_data$SSCI)
#sum(regression_2_data$SSCI, na.rm = T)
#mean(regression_2_data$SSCI, na.rm = T)
model_21_fit <- glm(Admission_Status ~ Female, data = regression_2_data, family = binomial(link = "logit"))
#summary(model_21_fit)
model_22_fit <- glm(Admission_Status ~ Female + Cohort_2020, data = regression_2_data, family = binomial(link = "logit"))
#summary(model_22_fit)
model_23_fit <- glm(Admission_Status ~ Female + Cohort_2020 + SBM + SENG + SSCI, data = regression_2_data, family = binomial(link = "logit"))
#summary(model_23_fit)
model_24_fit <- glm(Admission_Status ~ Female + Cohort_2020 + SBM + SENG + SSCI + Overall_Score, data = regression_2_data, family = binomial(link = "logit"))
#summary(model_24_fit)
model_25_fit <- glm(Admission_Status ~ Female + Cohort_2020 + SBM + SENG + SSCI + Overall_Score + Best_Math + Best_English + Best_Liberal_Studies, data = regression_2_data, family = binomial(link = "logit"))
#summary(model_25_fit)
View(regression_2_data)
View(regression_2_data)
specmod <- "
# Path a (direct effect): Gender to Admission Status
Admission_Status ~ a * Female
# Path b: Gender to JUPAS Math Score
Best_Math ~ b * Female
# Path c: JUPAS Math Score to Admission Status
Admission_Status ~ c * Best_Math
# Path d: Gender to JUPAS English Score
Best_English ~ d * Female
# Path e: JUPAS English Score to Admission Status
Admission_Status ~ e * Best_English
# Path f: Gender to JUPAS Liberal Studies Score
Best_Liberal_Studies ~ f * Female
# Path g: JUPAS Liberal Studies Score to Admission Status
Admission_Status ~ g * Best_Liberal_Studies
# Indirect Effects: Sobel Test (Delta Method)
bc := b * c
de := d * e
fg := f * g
"
fitmod_2 <- sem(specmod, data = regression_2_data, se = "bootstrap", bootstrap = 5000)
parameterEstimates(fitmod_2, ci = TRUE, level = 0.95, boot.ci.type = "perc")
summary(fitmod_2)
parameterEstimates(fitmod_2, ci = TRUE, level = 0.95, boot.ci.type = "perc")
summary(fitmod_2)
summary(fitmod_2, fit.measures = T)
parameterEstimates(fitmod_1, ci = TRUE, level = 0.95, boot.ci.type = "perc")
parameterEstimates(fitmod_2, ci = TRUE, level = 0.95, boot.ci.type = "perc")
